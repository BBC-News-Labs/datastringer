<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>test</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>
</head>

<body>
  <div class="container">
    <ul id="list"></ul>
  </div>
  <script>
  $(document).ready(function() {
    $.ajax({
      type: "GET",
      url: "dataprops/no10.xml",
      dataType: "xml",
      success: getStuff
    });

    var keyword = "immigration";

    function getStuff(xml, keyword) {
      console.log(xml);
      var linksArray = new Array();

      $(xml).find("link").each(function() {
        var $link = $(this);
        var link = $link.attr("href");
        linksArray.push(link);
      })

      var entries = new Array();
      var title = new Array();
      $(xml).find("entry").each(function() {
        //console.log(this);
        $(this).find("title").each(function() {
          var $title = $(this);
          title.push($title);
        });
        $(this).find("content").each(function() {
          var $entries = $(this);
          entries.push($entries);
        });
      })
      //console.log(title[1][0].textContent);
      //console.log(entries[1][0].textContent);

      //parser
      for (var i = 0; i < entries.length; i++) {
        var splits = entries[i][0].textContent.split(" ");

        if (_.contains(splits, keyword)) {
          //if true, word is present
          //to do: if true, trigger something
          //return only entries[i] in which the word is present. BRAINFUCK
        }
      }

      //CROS problem
      /*var juicerCall = "http://juicer.herokuapp.com/api/article?url=";
      for (var i = 0; i < linksArray.length; i++) {
        $.ajax({
          type: "GET",
          url: juicerCall + linksArray[i],
          dataType: "jsonp",
          crossDomain: true,
          success: pouet
        });
      }

      function pouet(json) {
        //console.log(json);
        var parsedJson = JSON.parse(json);
        console.log(parsedJson);
      }*/
    }
  });
  </script>
</body>

</html>
